**网易后端开发中的Netty最佳实例（网易邮箱）**



可扩容，弹性应用

![](集群推送消息架构.png)



![](整体结构.png)



![](推送服务.png)



优化

#### 1、Handler复用

![](优化1.png)



```java
@ChannelHandler.Sharable//标识为可共享
```

![](Handler共享.png)



![](编解码器不共享.png)



![](编解码器默认不共享.png)



#### 2、耗时操作引入专用线程池

![](优化2.png)





![](NioEventLoop功能.png)



#### 3、分批推送，防止IO线程被一个连接长时间占用



![](优化3.png)



#### 4、线程模型、责任链、ByteBuf

ByteBuf高性能：对象复用、零拷贝、内存复用



![](内存复用.png)



![](对象复用.png)

