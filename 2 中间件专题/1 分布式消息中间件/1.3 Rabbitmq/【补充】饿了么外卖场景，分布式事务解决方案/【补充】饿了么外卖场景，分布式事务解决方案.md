**饿了么外卖场景，分布式事务解决方案**



![](目录.png)



# 1.5分钟了解MQ

![](了解RabbitMQ.png)



# 2.分布式事务问题

![](分布式事务几种解决方案.png)



![](美团点评系统架构.png)



![](多系统之间的分布式事务问题.png)



![](错误示例.png)



# 3.实现分布式事务的5个步骤

![](整体设计思路.png)



## 可靠消息生产-记录消息发送

![](可靠消息生产-记录消息发送.png)



## 可靠消息生产-修改消息发送状态

![](可靠消息生产-修改消息发送状态.png)



## 可靠消费处理-正常处理

![](可靠消费处理-正常处理.png)



## 可靠消费处理-消息重发

![](可靠消费处理-消息重发.png)



## 可靠消费处理-消息丢弃

![](可靠消费处理-消息丢弃.png)



# 4.总结及扩展

​	ActiveMQ、RabbitMQ、RocketMQ有可靠消息机制。kafka主要是OLAP。RocketMQ偏向OLTP。

![](优缺点.png)



![](扩展.png)

